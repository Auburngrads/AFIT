\usepackage{hyperref}
\usepackage[font={bf,footnotesize},labelsep=period]{caption}
\usepackage{geometry}
\usepackage{setspace}
\usepackage{indentfirst}
\usepackage{float}
\usepackage{flafter}
\usepackage{amssymb,amsmath,amsfonts}
\usepackage{theorem}
%\usepackage[square]{natbib}
\usepackage{varioref} 
\usepackage{tocbibind} 
\usepackage{listings} 
\usepackage{xspace}
\usepackage{fixltx2e}
\usepackage{threeparttable}
\usepackage{booktabs}
\usepackage{color}
\usepackage{url}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[raggedright]{titlesec}
\usepackage{titletoc}
\usepackage{ifpdf}
\ifpdf
\usepackage[pdftex]{graphicx}
\DeclareGraphicsExtensions{.jpg, .pdf, .png}
\else
\usepackage{graphicx}
\DeclareGraphicsExtensions{.eps}
\fi

%% Define default document values
\geometry{top=1in,bottom=1.25in,left=1.25in,right=1.25in}
\def\afittocfootskip{0.41in}      %if above margins change, routines 
                                  %using this command may require 
                                  %retuning (alm)
\def\tocSpace{0.0em}
\def\lofSpace{1.0em plus 1pt}
\def\tocStart{1.0em plus 1pt}
\def\lofStart{0.0in}

\makeindex
\doublespacing  % options include \singlespacing, \onehalfspacing, 
                % \doublespacing or \setstretch{baselinestretch}
\pagestyle{plain}

% Some color definitions...
\definecolor{LemonChiffon}{rgb}{1.,0.98,0.8}
\definecolor{LightBlue}{rgb}{0.68,0.85,0.9}
\definecolor{USAFblue}{rgb}{.1,.1,.6}
\definecolor{Pink}{rgb}{1,0.75,0.8}
\definecolor{Gold}{rgb}{1,0.84,0}
\definecolor{Reda}{rgb}{0.9,0.3,0.7}
\definecolor{Redb}{rgb}{0.9,0.3,1}
\definecolor{Beige}{rgb}{0.96,0.96,0.86}
\definecolor{Yellow}{rgb}{1,0.84,0.8}
\definecolor{LightCyan}{rgb}{0.88,1,1}
\definecolor{FireOrange}{rgb}{0.9,0.4,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{LTgray}{gray}{0.8}
\definecolor{DKgray}{gray}{0.3}	
\definecolor{Green}{rgb}{0,0.4,0}
%==================================================================
%		TABLE OF CONTENTS, LIST OF FIGURES/TABLE, etc.             
%==================================================================
%    define PAGE STYLES for the table of contents places headings
%    within the designated margins and adjusts the textheight
%    accordingly.  This code is not pretty.  When redefining vertical
%    margins, command \vsplit is the key to success
  
\def\listEntry{Entry}
\def\ps@afittoc{%
	\let\@mkboth\@gobbletwo
	\def \@oddhead{}
	\def \@oddfoot{\rm 
	      \hfil{\thepage}\hfil\thispagestyle{afittocn}}
	\let \@evenhead\@oddhead \let \@evenfoot\@oddfoot
	\footskip=\afittocfootskip
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                 %
%   \def\ps@afittocn{                                             %
%           \let\@mkboth\@gobbletwo                               %
%           \def \@oddhead{}                                      %
%           \def \@oddfoot{\rm                                    %
%                 \hfil{\thepage}\hfil\thispagestyle{afittocn}}   %
%           \let \@evenhead\@oddhead \let \@evenfoot\@oddfoot     %
%           \footskip=\afittocfootskip                            %
%   }                                                             %
%                                                                 %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newbox\@tocboxa
\newbox\@tocboxb
\def\ps@afittocn{
        \let\@mkboth\@gobbletwo	
	\def \@oddhead{}
	\def \@oddfoot{\rm
	      \hfil{\thepage}\hfil\thispagestyle{afittocn}}
	\let \@evenhead\@oddhead \let \@evenfoot\@oddfoot
	\footskip=\afittocfootskip 
 	\setbox\@outputbox\vbox{\listEntry\hfill{Page} \tocSkipStart 
	\unvbox\@tocboxa \tocSkip 
	                 \unvbox\@outputbox}        
	\setbox\@tocboxb\vsplit\@outputbox to\textheight
        \global\setbox\@tocboxa\vbox{\tocSkip \unvbox\@outputbox \unskip}
	\setbox\@outputbox\copy\@tocboxb 
}

% =====================  TABLE OF CONTENTS  =======================
\renewcommand\@pnumwidth{0em {\hss}}
\renewcommand{\@dotsep}{2}
\renewcommand{\@tocrmarg}{4em plus2fil}
\newif\if@toc \@tocfalse
\renewcommand\tableofcontents{%
    \vspace*{-20pt}
    \if@twocolumn
      \@restonecoltrue\onecolumn
    \else
      \@restonecolfalse
    \fi
    \begingroup% temporarily set if@toc so that \@schapter will not
	        % put Table of Contents in the table of contents.
      \@toctrue
      \chapter*{\contentsname}
    \endgroup
    \def\listEntry{\@empty}
    \thispagestyle{afittoc}
    \baselineskip=14pt 
    \def\tocSkip{\vskip \tocSpace}
    \def\tocSkipStart{\vskip \tocStart}
    {\raggedleft Page \vskip 1.0em \par\vskip-\parskip} 
    \@starttoc{toc}%
    \newpage   
    \ifx\@tocboxa\@empty 
    \else
      \thispagestyle{afittocn}
      \unvbox\@tocboxa
      \newpage
    \fi 
    \if@restonecol\twocolumn\fi 
    \baselineskip=\normalbaselineskip
    \thispagestyle{plain}
  }

\def\l@appendix{\pagebreak[3]
 \vskip \tocSpace % space above appendix line
  \@dottedtocline{0}{0em}{6.4em}}

\def\l@chapter{\pagebreak[3]
 \vskip \tocSpace 
  \@dottedtocline{0}{0em}{2.4em}}

% For documents with more than 7 chapters you'll need to make
% adjustments here
\renewcommand\l@section{\@dottedtocline{1}{2.4em}{2em}}
\renewcommand\l@subsection{\@dottedtocline{2}{4.4em}{3em}}
\renewcommand\l@subsubsection{\@dottedtocline{3}{7.4em}{4em}}
%\renewcommand\l@paragraph{\@dottedtocline{4}{13.5em}{5em}}
%\renewcommand\l@subparagraph{\@dottedtocline{5}{16em}{6em}}
% =====================  LIST OF FIGURES  =======================
\renewcommand\listoffigures{%
  \@restonecolfalse\if@twocolumn\@restonecoltrue\onecolumn\fi
  \chapter*{\listfigurename}%
  \def\listEntry{Figure}
  \addcontentsline{toc}{chapter}{List of Figures}
  \addtocontents{toc}{\protect\addvspace{10pt}}
  \thispagestyle{afittoc}
  \baselineskip=14pt% 
  \def\tocSkip{\vskip \lofSpace}
  \def\tocSkipStart{\vskip \lofStart}

  {\hbox to \hsize{Figure\hfil Page} \vskip 0.0em \par\vskip-\parskip}%
  
  \@starttoc{lof}%
    \newpage   
    \ifx\@tocboxa\@empty 
    \else
      \thispagestyle{afittocn}
      \unvbox\@tocboxa
      \newpage
    \fi 
   \if@restonecol\twocolumn\fi
   \baselineskip=\normalbaselineskip 
   \thispagestyle{plain}
}%

\def\l@figure{\pagebreak[3]
 \vskip \lofSpace 
 \@dottedtocline{1}{0.25em}{4.0em}}
% =====================  LIST OF TABLES  =======================
\renewcommand\listoftables{%
  \@restonecolfalse\if@twocolumn\@restonecoltrue\onecolumn\fi
  \chapter*{\listtablename}%
  \def\listEntry{Table}
  \addcontentsline{toc}{chapter}{List of Tables}
  \addtocontents{toc}{\protect\addvspace{10\p@}}
  \thispagestyle{afittoc}
  \baselineskip=14pt%  
  \def\tocSkip{\vskip \lofSpace}
  \def\tocSkipStart{\vskip \lofStart}

  {\hbox to \hsize{Table\hfil Page} \vskip 0.0em\par\vskip-\parskip}%   changed to 0.0em

  \@starttoc{lot}%
    \newpage   
    \ifx\@tocboxa\@empty 
    \else
      \thispagestyle{afittocn}
      \unvbox\@tocboxa
      \newpage
    \fi 
  \if@restonecol\twocolumn\fi
  \baselineskip=\normalbaselineskip 
  \thispagestyle{plain}
}%
